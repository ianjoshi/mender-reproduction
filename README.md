# MENDER Reproduction & Exploration

This repository contains a reproduction of key figures and additional research based on the original MENDER paper:

> **MENDER: Fast and scalable tissue structure identification in spatial omics data**  
> Zhiyuan Yuan et al., Nature Communications, 2024  
> [DOI: 10.1038/s41467-023-44367-9](https://doi.org/10.1038/s41467-023-44367-9)

## Description

This project reproduces the following figures from the original MENDER paper:

- **Figure 4H**: UMAP embedding applied on top of the MENDER cellular context representation of the MERSCOPE data.

-   **Figure 5A**: MENDER-UMAP of the MERFISH aging dataset, colored by:

    -   Expert annotations from the original publication
    -   MENDER results

All reproduction code can be found in the `reproductions` directory.

In addition to reproduction, the project explores **three novel research questions**, extending or adapting MENDER to new challenges:

1. "Can integrating additional data modalities (e.g., imaging data) stabilize and enhance spatial domain predictions generated by MENDER? Is Principal Component Analysis (PCA) sufficient for effective cell typing, or do learned cell representations provide superior accuracy and robustness?" by Phuong Ho (see `phuong_ho`)
2. "How do approximate nearest neighbor techniques and alternative linear dimensionality reduction methods impact the quality of identified spatial domains and the computational efficiency of the MENDER framework in spatial transcriptomics?" by Inaesh Joshi (see `sparse-mender`)
3. "How does the choice of dimensionality reduction method (PCA versus UMAP) affect cell-type inference and spatial domain identification in spatial transcriptomics?" by Juul Schnitzler (see `juul_schnitzler`)

---

## Setup Instructions

This project requires **Python 3.10.11**. You can use `pyenv` or `conda` to install the correct version.

1. Clone the repository:

    ```bash
    git clone https://github.com/ianjoshi/mender-reproduction.git
    cd mender-reproduction
    ```

2. Create and activate a virtual environment:

    ```bash
    # On Windows use
    py -3.10 -m venv mender-venv
    mender-venv/Scripts/activate
    ```

3. Install dependencies:
    ```bash
    pip install -r requirements.txt
    ```

---

## References

-   Yuan, Z. et al. _MENDER: Fast and scalable tissue structure identification in spatial omics data_. Nature Communications (2024).
    [DOI: 10.1038/s41467-023-44367-9](https://doi.org/10.1038/s41467-023-44367-9)

---

## Authors

-   Ho Thi Ngoc Phuong \[[hothingocphuong@student.tudelft.nl](mailto:hothingocphuong@student.tudelft.nl)]
-   Inaesh Joshi \[[i.joshi-2@student.tudelft.nl](mailto:i.joshi-2@student.tudelft.nl)]
-   Juul Schnitzler \[[j.b.Schnitzler@student.tudelft.nl](mailto:j.b.Schnitzler@student.tudelft.nl)]
